(this.webpackJsonpmusicfromspotify=this.webpackJsonpmusicfromspotify||[]).push([[0],[,,,,,,,,,,,,,function(e,t,a){e.exports=a.p+"static/media/loginHeadphones.1df5799c.jpg"},,,,function(e,t,a){e.exports=a(47)},,,,,function(e,t,a){},,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(5),s=a.n(c),l=(a(22),a(1)),i=(a(29),a(30),a(13)),u=a.n(i),o=(a(31),"https://accounts.spotify.com/authorize?client_id=".concat("4d305e8a665a43b59a5e7f5f71e265df","&response_type=code&redirect_uri=").concat("https://mkphercog.github.io/musicfromspotify/","&scope=").concat("user-read-email")),m=function(){var e=window.location.href;return e.includes("code")?e.slice(e.indexOf("=")+1,e.length):""},f=function(e,t,a){var r=new URLSearchParams;r.append("grant_type","refresh_token"),r.append("refresh_token",e);var n=new Headers;n.append("Authorization","Basic ".concat(btoa("4d305e8a665a43b59a5e7f5f71e265df:fc67cf47ac024e2cb3a703b27e2bdd71"))),fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:n,body:r}).then((function(e){if(200===e.status)return e.json();throw new Error})).then((function(r){t(a(r.access_token,e))})).catch((function(e){return console.log(e)}))},b=function(){return n.a.createElement("div",{className:"login-page__buttons"},n.a.createElement("a",{className:"login-page__login-btn",href:o},"Zaloguj si\u0119 do Spotify"),n.a.createElement("a",{className:"login-page__register-btn",href:"https://www.spotify.com/pl/signup/"},"Nie masz konta? Za\u0142\xf3\u017c je tutaj."))},_=function(){return n.a.createElement("div",{style:{backgroundImage:"url(".concat(u.a,")")},className:"login-page"},n.a.createElement(b,null))},p=(a(32),a(33),function(){return n.a.createElement("header",{className:"header"},n.a.createElement("h1",{className:"header__title"},"Music from ",n.a.createElement("span",{className:"header__spotify"},"Spotify")))}),h=(a(34),a(16)),d=(a(35),a(36),function(e){var t=e.inputValue,a=e.setInputValue,r=e.isSearchResultsVisible,c=e.showResults,s=e.dispatch;return n.a.createElement("input",{className:"search-section__input",placeholder:"Wyszukaj...",type:"text",value:t,onClick:function(){r||s(c())},onChange:function(e){return a(e.target.value)}})}),E=(a(37),function(){return n.a.createElement("button",{className:"search-section__search-btn"},n.a.createElement("i",{className:"fas fa-search"}))}),k=(a(38),a(39),function(e){return{type:"DELETE_ALBUM_FROM_LIST",albumID:e}}),A=function(e,t){return{type:"SET_ACCESS_TOKENS",access_token:e,refresh_token:t}},T=function(e){return{type:"DATA_ERROR",errorMessage:e}},N=(a(40),function(){return n.a.createElement("div",{className:"loading-page"},n.a.createElement("p",{className:"loading-page__name"},"Wczytuje dane..."))}),g=function(e){var t=e.listOfAlbums,a=Object(l.c)((function(e){return e.fetchData.featching})),r=Object(l.c)((function(e){return e.authorization})),c=Object(l.c)((function(e){return e.favouriteAlbums.favouriteAlbums})),s=r.access_token,i=r.refresh_token,u=Object(l.b)(),o=t.filter((function(e){return"album"===e.album_type})).map((function(e){var t=c.find((function(t){return e.id===t.albumID}));return n.a.createElement("div",{key:e.id,className:"search-section__result"},n.a.createElement("p",{className:"search-section__description"},e.name),n.a.createElement("img",{className:"search-section__album-image",src:e.images[1].url,alt:"Album"}),n.a.createElement("p",{className:"search-section__description"},e.artists[0].name),n.a.createElement("button",{className:"search-section__add-to-favourite",disabled:t,onClick:function(){u({type:"DATA_FETCHING"}),function(e){fetch("https://api.spotify.com/v1/albums/".concat(e.id,"/tracks"),{headers:{Authorization:"Bearer ".concat(s)}}).then((function(e){if(200===e.status)return e.json();throw new Error})).then((function(t){var a={albumIMG:e.images[1].url,albumID:e.id,albumName:e.name,artistName:e.artists[0].name,tracks:t.items,spotifyAlbumURL:e.external_urls.spotify,totalTracks:e.total_tracks};u({type:"DATA_FETCHED"}),u(function(e){return{type:"ADD_ALBUM_TO_LIST",albumIMG:e.albumIMG,albumID:e.albumID,albumName:e.albumName,artistName:e.artistName,tracks:e.tracks,spotifyAlbumURL:e.spotifyAlbumURL,totalTracks:e.totalTracks}}(a))})).catch((function(e){u(T(e.message)),f(i,u,A)}))}(e)}},t?"Dodano do ulubionych":"Dodaj do ulubionych"))}));return n.a.createElement(n.a.Fragment,null,a?n.a.createElement(N,null):null,o)},y=function(e){var t=e.listOfAlbums,a=e.hideSearchResults,r=e.dispatch,c=e.setInputValue,s=e.searchAlbums;return n.a.createElement("div",{className:"search-section___wrapper"},n.a.createElement("div",{className:"search-section__results"},t.length?n.a.createElement(g,{listOfAlbums:t}):n.a.createElement("p",{className:"search-section__no-results"},"Brak wynik\xf3w wyszukiwania")),n.a.createElement("button",{className:"search-section__close",onClick:function(){r(a()),c(""),r(s([]))}},"Zamknij wyszukiwark\u0119"))},v=function(e){return{type:"SEARCH_ALBUMS",listOfAlbums:e}},S=function(){return{type:"SHOW_SEARCH_RESULTS",isSearchResultsVisible:!0}},R=function(){return{type:"HIDE_SEARCH_RESULTS",isSearchResultsVisible:!1}},O=function(){var e=Object(l.c)((function(e){return e.fetchData.featching})),t=Object(l.c)((function(e){return e.searching})),a=Object(l.c)((function(e){return e.authorization})),c=t.isSearchResultsVisible,s=t.listOfAlbums,i=a.access_token,u=a.refresh_token,o=Object(r.useState)(""),m=Object(h.a)(o,2),b=m[0],_=m[1],p=Object(l.b)();return n.a.createElement("section",{className:"search-section"},e?n.a.createElement(N,null):null,n.a.createElement("form",{className:"search-section__form",onSubmit:function(e){c||p({type:"SHOW_SEARCH_RESULTS",isSearchResultsVisible:!0}),function(e){e.preventDefault(),""!==b?(p({type:"DATA_FETCHING"}),fetch("https://api.spotify.com/v1/search?q=".concat(b,"&type=album"),{headers:{Authorization:"Bearer ".concat(i)}}).then((function(e){if(200===e.status)return e.json();throw new Error})).then((function(e){p({type:"DATA_FETCHED"}),p(v(e.albums.items))})).catch((function(e){p(T(e.message)),f(u,p,A)}))):p(v([]))}(e)}},n.a.createElement("div",{className:"search-section__relative"},n.a.createElement(d,{inputValue:b,setInputValue:_,isSearchResultsVisible:c,showResults:S,dispatch:p}),n.a.createElement(E,null))),n.a.createElement("div",{className:"search-section__results-position"},c?n.a.createElement(y,{dispatch:p,hideSearchResults:R,listOfAlbums:s,setInputValue:_,searchAlbums:v}):null))},D=(a(41),a(42),a(43),function(e,t){return{type:"SET_CURRENT_TRACK",currentTrackName:e.name,currentTrackURL:e.preview_url,currentTrackNumber:e.track_number,allTracksInAlbum:t.totalTracks,currentAlbumArtist:t.artistName,tracks:t.tracks}}),I=function(){return{type:"STOP_PLAYING_TRACK"}},C=function(e,t,a){return{type:"NEXT_PREV_TRACK",currentTrackName:e,currentTrackURL:t,currentTrackNumber:a}},L=function(e){var t=e.track,a=e.isTrackPlaying,r=e.stopBtnClasses,c=e.trackClasses,s=e.dispatch,l=e.stopMusic,i=e.setCurrentTrack,u=e.albumDetails;return n.a.createElement("div",{className:"albums-section__track-wrapper"},t.preview_url?a?n.a.createElement("button",{className:r,onClick:function(){s(l())}},n.a.createElement("i",{className:"fas fa-stop"})):n.a.createElement("button",{className:"albums-section__details-track-button",onClick:function(){s(i(t,u)),s({type:"PLAY_CURRENT_TRACK"})}},n.a.createElement("i",{className:"fas fa-play"})):n.a.createElement("button",{className:"albums-section__details-track-button",disabled:!0},n.a.createElement("i",{className:"fas fa-play"})),n.a.createElement("p",{className:c},t.track_number,". ",t.name))},w=function(e){var t=e.albumDetails,a=e.isPlaying,r=e.currentTrack,c=e.dispatch,s=e.hideAlbumDetails,l=e.deleteAlbumFromList,i=t.tracks.map((function(e){var s=a&&r===e.preview_url,l=s?"albums-section__details-track-name albums-section__details-track-name--green":"albums-section__details-track-name",i=s?"albums-section__details-track-button albums-section__details-track-button--green":"albums-section__details-track-button";return n.a.createElement(L,{key:e.id,track:e,isTrackPlaying:s,stopBtnClasses:i,trackClasses:l,dispatch:c,stopMusic:I,setCurrentTrack:D,albumDetails:t})}));return n.a.createElement("div",{className:"albums-section__details-album"},n.a.createElement("div",{className:"albums-section__album-info-wrapper"},n.a.createElement("img",{className:"albums-section__details-image",src:t.albumIMG,alt:"Album"}),n.a.createElement("div",{className:"albums-section__details-name-wrapper"},n.a.createElement("h1",{className:"albums-section__details-artist-name"},t.artistName),n.a.createElement("h2",{className:"albums-section__details-album-name"},t.albumName)),n.a.createElement("div",{className:"albums-section__details-buttons-wrapper"},n.a.createElement("a",{className:"albums-section__details-full-album-spotify",href:t.spotifyAlbumURL,target:"_blank",rel:"noopener noreferrer"},"Pe\u0142ny album znajdziesz tutaj"),n.a.createElement("button",{className:"albums-section__details-delete-album",onClick:function(){c(s()),c(l(t.albumID))}},"Usu\u0144 album z ulubionych"))),n.a.createElement("div",{className:"albums-section__tracks-wrapper"},i),n.a.createElement("button",{className:"albums-section__details-close",onClick:function(){return c(s())}},n.a.createElement("i",{className:"fas fa-times"})))},j=(a(44),function(e){var t=e.album,a=e.dispatch,r=e.showAlbumDetails,c=e.setAlbumDetails;return n.a.createElement("div",{className:"albums-section__wrapper"},n.a.createElement("img",{src:t.albumIMG,alt:"Album",className:"albums-section__image"}),n.a.createElement("div",{className:"albums-section__hover-div",onClick:function(){a(c({albumIMG:t.albumIMG,albumID:t.albumID,albumName:t.albumName,artistName:t.artistName,tracks:t.tracks,spotifyAlbumURL:t.spotifyAlbumURL,totalTracks:t.totalTracks})),a(r())}},n.a.createElement("p",{className:"albums-section__name-hover"},t.artistName),n.a.createElement("p",{className:"albums-section__name-hover"},t.albumName)))}),U=(a(45),function(e){var t=e.tracks,a=Object(l.b)(),c=Object(l.c)((function(e){return e.player})),s=c.currentTrackURL,i=c.currentTrackName,u=c.currentAlbumArtist,o=c.currentTrackNumber,m=c.allTracksInAlbum,f=c.isPlaying,b=c.trackCurrentTime;Object(r.useEffect)((function(){var e;return f&&(e=setInterval((function(){a({type:"PAUSE_PLAYING_TRACK"}),_()}),3e4-1e3*b)),function(){return clearInterval(e)}}),[f,s]);var _=function(){if(s){if(o===m){var e=t.filter((function(e){return 1===e.track_number}));console.log(e),a(C(e[0].name,e[0].preview_url,1))}else{var r=t.filter((function(e){return e.track_number===o+1}));a(C(r[0].name,r[0].preview_url,r[0].track_number))}a({type:"PLAY_CURRENT_TRACK"})}};return n.a.createElement("div",{className:"player"},n.a.createElement("p",{className:"player__track-name"},"".concat(o||"",". ").concat(u," - ").concat(i)),n.a.createElement("div",{className:"player__btn-wrapper"},n.a.createElement("button",{className:"player__controlers",onClick:function(){if(s){if(1===o){var e=t.filter((function(e){return e.track_number===m}));a(C(e[0].name,e[0].preview_url,m))}else{var r=t.filter((function(e){return e.track_number===o-1}));a(C(r[0].name,r[0].preview_url,o-1))}a({type:"PLAY_CURRENT_TRACK"})}}},n.a.createElement("i",{className:"fas fa-step-forward player__prev"})),n.a.createElement("button",{className:"player__controlers",onClick:function(){s&&a({type:"STOP_PLAYING_TRACK"})}},n.a.createElement("i",{className:"fas fa-stop"})),f?n.a.createElement("button",{className:"player__controlers",onClick:function(){s&&a({type:"PAUSE_PLAYING_TRACK"})}},n.a.createElement("i",{className:"fas fa-pause"})):n.a.createElement("button",{className:"player__controlers",onClick:function(){s&&a({type:"PLAY_CURRENT_TRACK"})}},n.a.createElement("i",{className:"fas fa-play"})),n.a.createElement("button",{className:"player__controlers",onClick:_},n.a.createElement("i",{className:"fas fa-step-forward"}))))}),M=function(){return{type:"SHOW_ALBUM_DETAILS",isAlbumDetailsVisible:!0}},P=function(){return{type:"HIDE_ALBUM_DETAILS",isAlbumDetailsVisible:!1}},H=function(e){return{type:"SET_ALBUM_DETAILS",albumDetails:e}},V=function(){var e=Object(l.c)((function(e){return e.favouriteAlbums.favouriteAlbums})),t=Object(l.c)((function(e){return e.player})),a=Object(l.c)((function(e){return e.albumDetails})),r=a.albumDetails,c=a.isAlbumDetailsVisible,s=t.currentTrackURL,i=t.isPlaying,u=t.tracks,o=Object(l.b)(),m=e.map((function(e){return n.a.createElement(j,{key:e.albumID,album:e,dispatch:o,showAlbumDetails:M,setAlbumDetails:H})}));return n.a.createElement("section",{className:"albums-section"},m.length?m.reverse():n.a.createElement("div",{className:"albums-section__no-results"},n.a.createElement("p",{className:"albums-section__no-result-name"},"Brak album\xf3w")),c?n.a.createElement(w,{albumDetails:r,isPlaying:i,currentTrack:s,dispatch:o,hideAlbumDetails:P,deleteAlbumFromList:k}):null,i||s?n.a.createElement(U,{tracks:u}):null)},B=function(){return n.a.createElement("main",{className:"main"},n.a.createElement(O,null),n.a.createElement(V,null))},G=(a(46),function(){return n.a.createElement("footer",{className:"footer"},n.a.createElement("p",{className:"footer__author"},"Projekt i realizacja Marcin Hercog"))}),z=function(){return n.a.createElement("div",{className:"website-page"},n.a.createElement(p,null),n.a.createElement(B,null),n.a.createElement(G,null))},K=function(){var e=Object(l.c)((function(e){return e.authorization.access_token})),t=Object(l.c)((function(e){return e.fetchData.featching})),a=Object(l.b)(),c=function(){var e=m(),t=new Headers;t.append("Authorization","Basic ".concat(btoa("".concat("4d305e8a665a43b59a5e7f5f71e265df",":").concat("fc67cf47ac024e2cb3a703b27e2bdd71"))));var a=new URLSearchParams;return a.append("grant_type","authorization_code"),a.append("code",e),a.append("redirect_uri",String("https://mkphercog.github.io/musicfromspotify/")),{headers:t,urlencoded:a,fetchOptions:{method:"POST",headers:t,body:a,redirect:"follow"},codeToGetAccess:e}}(),s=c.codeToGetAccess,i=c.fetchOptions;return Object(r.useEffect)((function(){s&&!e&&(a({type:"DATA_FETCHING"}),fetch("https://accounts.spotify.com/api/token",i).then((function(e){if(200===e.status)return e.json();throw new Error})).then((function(e){a({type:"DATA_FETCHED"}),a(A(e.access_token,e.refresh_token))})).catch((function(e){a(T(e.message)),console.log(e)}))),s||(localStorage.setItem("access_token",""),localStorage.setItem("refresh_token","")),window.innerWidth>=1024&&a({type:"SHOW_SEARCH_RESULTS",isSearchResultsVisible:!0})}),[]),n.a.createElement("div",{className:"App"},t?n.a.createElement(N,null):null,e?n.a.createElement(z,null):n.a.createElement(_,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var F=a(3),W=a(14),Y=a(15),x=a(2),J={access_token:m()?String(localStorage.getItem("access_token")):"",refresh_token:localStorage.getItem("refresh_token")?String(localStorage.getItem("refresh_token")):""},Z={listOfAlbums:[],isSearchResultsVisible:!1},X=a(10),q=localStorage.getItem("favouriteAlbums")?localStorage.getItem("favouriteAlbums"):"",$={favouriteAlbums:q?JSON.parse(q):[]},Q=new Audio,ee={currentTrackName:"",currentTrackURL:"",isPlaying:!1,currentTrackNumber:0,allTracksInAlbum:0,currentAlbumArtist:"",tracks:[],trackCurrentTime:0},te={isAlbumDetailsVisible:!1,albumDetails:{albumIMG:"",albumID:"",albumName:"",artistName:"",tracks:[],spotifyAlbumURL:"",totalTracks:0}},ae={featching:!1,featched:!1,error:!1,errorMessage:""},re=Object(F.combineReducers)({authorization:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ACCESS_TOKENS":return localStorage.setItem("access_token",t.access_token),localStorage.setItem("refresh_token",t.refresh_token),Object(x.a)({},e,{access_token:t.access_token,refresh_token:t.refresh_token});default:return e}},searching:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_SEARCH_RESULTS":case"HIDE_SEARCH_RESULTS":return Object(x.a)({},e,{isSearchResultsVisible:t.isSearchResultsVisible});case"SEARCH_ALBUMS":return Object(x.a)({},e,{listOfAlbums:t.listOfAlbums});default:return e}},favouriteAlbums:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_ALBUM_TO_LIST":var a={albumIMG:t.albumIMG,albumID:t.albumID,albumName:t.albumName,artistName:t.artistName,tracks:t.tracks,spotifyAlbumURL:t.spotifyAlbumURL,totalTracks:t.totalTracks};return localStorage.setItem("favouriteAlbums",JSON.stringify([].concat(Object(X.a)(e.favouriteAlbums),[a]))),Object(x.a)({},e,{favouriteAlbums:[].concat(Object(X.a)(e.favouriteAlbums),[a])});case"DELETE_ALBUM_FROM_LIST":var r=e.favouriteAlbums.filter((function(e){return e.albumID!==t.albumID}));return localStorage.setItem("favouriteAlbums",JSON.stringify(r)),Object(x.a)({},e,{favouriteAlbums:r});default:return e}},player:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_TRACK":return Q.src=t.currentTrackURL,Object(x.a)({},e,{currentTrackName:t.currentTrackName,currentTrackURL:t.currentTrackURL,isPlaying:!1,currentTrackNumber:t.currentTrackNumber,allTracksInAlbum:t.allTracksInAlbum,currentAlbumArtist:t.currentAlbumArtist,tracks:t.tracks,trackCurrentTime:Q.currentTime});case"PLAY_CURRENT_TRACK":return Q.play(),Object(x.a)({},e,{isPlaying:!0});case"STOP_PLAYING_TRACK":return Q.pause(),Object(x.a)({},e,{currentTrackName:"",currentTrackURL:"",isPlaying:!1,currentTrackNumber:"",allTracksInAlbum:0,currentAlbumArtist:""});case"PAUSE_PLAYING_TRACK":return Q.pause(),Object(x.a)({},e,{isPlaying:!1,trackCurrentTime:Q.currentTime});case"NEXT_PREV_TRACK":return Q.src=t.currentTrackURL,Object(x.a)({},e,{currentTrackName:t.currentTrackName,currentTrackURL:t.currentTrackURL,currentTrackNumber:t.currentTrackNumber,trackCurrentTime:0});default:return e}},albumDetails:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_ALBUM_DETAILS":case"HIDE_ALBUM_DETAILS":return Object(x.a)({},e,{isAlbumDetailsVisible:t.isAlbumDetailsVisible});case"SET_ALBUM_DETAILS":return Object(x.a)({},e,{albumDetails:t.albumDetails});default:return e}},fetchData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DATA_FETCHING":return Object(x.a)({},e,{featching:!0,featched:!1,error:!1,errorMessage:""});case"DATA_FETCHED":return Object(x.a)({},e,{featching:!1,featched:!0,error:!1,errorMessage:""});case"DATA_ERROR":return Object(x.a)({},e,{featching:!1,featched:!1,error:!0,errorMessage:t.errorMessage});default:return e}}}),ne=Object(Y.composeWithDevTools)(Object(F.applyMiddleware)(W.a)),ce=Object(F.createStore)(re,ne);s.a.render(n.a.createElement(l.a,{store:ce},n.a.createElement(n.a.StrictMode,null,n.a.createElement(K,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[17,1,2]]]);
//# sourceMappingURL=main.1f33f35c.chunk.js.map